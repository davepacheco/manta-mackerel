{
  "mantaBaseDirectory": "/poseidon/stor/usage",
  "lookupFile": "assets/etc/lookup.json",
  "jobs": {


    "storage": {
      "hourly": {
        "keygen": "StorageHourlyKeyGenerator",
        "keygenArgs": {
          "source": "/poseidon/stor/manatee_backups"
        },
        "linkPath": "/poseidon/stor/usage/storage/latest-hourly",
        "job": {
          "name": "metering-storage-hourly-$year-$month-$dayT$hour",
          "phases": [
            {
              "type": "map",
              "assets": [
                "/poseidon/stor/usage/assets/node_modules.tar",
                "/poseidon/stor/usage/assets/bin/storage-map",
                "/poseidon/stor/usage/assets/lib/storage-map.js"
              ],
              "exec": "/assets/poseidon/stor/usage/assets/bin/storage-map"
            },
            {
              "type": "reduce",
              "memory": 2048,
              "assets": [
                "/poseidon/stor/usage/assets/node_modules.tar",
                "/poseidon/stor/usage/assets/bin/storage-reduce1",
                "/poseidon/stor/usage/assets/lib/storage-reduce1.js"
              ],
              "exec": "/assets/poseidon/stor/usage/assets/bin/storage-reduce1",
              "count": 1
            },
            {
              "type": "reduce",
              "assets": [
                "/poseidon/stor/usage/assets/node_modules.tar",
                "/poseidon/stor/usage/assets/bin/sum-columns",
                "/poseidon/stor/usage/assets/lib/sum-columns.js"
              ],
              "exec": "/assets/poseidon/stor/usage/assets/bin/sum-columns",
              "count": 1
            },
            {
              "type": "reduce",
              "assets": [
                "/poseidon/stor/usage/assets/node_modules.tar",
                "/poseidon/stor/usage/assets/bin/storage-reduce3",
                "/poseidon/stor/usage/assets/lib/storage-reduce3.js"
              ],
              "exec": "/assets/poseidon/stor/usage/assets/bin/storage-reduce3",
              "count": 1
            },
            {
              "type": "reduce",
              "assets": [
                "/poseidon/stor/usage/assets/node_modules.tar",
                "/poseidon/stor/usage/assets/bin/deliver-usage",
                "/poseidon/stor/usage/assets/etc/lookup.json",
                "/poseidon/stor/usage/assets/lib/deliver-usage.js"
              ],
              "exec": "/assets/poseidon/stor/usage/assets/bin/deliver-usage",
              "count": 1
            }
          ]
        },
        "env": {
          "NAMESPACES": "stor public jobs reports",
          "ZCAT": "gzcat",
          "HEADER_CONTENT_TYPE": "application/x-json-stream",
          "DEST": "/poseidon/stor/usage/storage/$year/$month/$day/$hour/h$hour.json",
          "USER_DEST": "/reports/usage/storage/$year/$month/$day/$hour/h$hour.json"
        }
      },


      "daily": {
        "keygen": "FindKeyGenerator",
        "keygenArgs": {
          "source": "/poseidon/stor/usage/storage/$year/$month/$day",
          "regex": "h[0-9][0-9]"
        },
        "linkPath": "/poseidon/stor/usage/storage/latest-daily",
        "job": {
          "name": "metering-storage-daily-$year-$month-$day",
          "phases": [
            {
              "type": "reduce",
              "assets": [
                "/poseidon/stor/usage/assets/node_modules.tar",
                "/poseidon/stor/usage/assets/bin/sum-columns",
                "/poseidon/stor/usage/assets/lib/sum-columns.js"
              ],
              "exec": "/assets/poseidon/stor/usage/assets/bin/sum-columns",
              "count": 1
            }
          ]
        },
        "env": {
          "HEADER_CONTENT_TYPE": "application/x-json-stream",
          "DEST": "/poseidon/stor/usage/storage/$year/$month/$day/d$day.json"
        }
      },


      "monthly": {
        "keygen": "FindKeyGenerator",
        "keygenArgs": {
          "source": "/poseidon/stor/usage/storage/$year/$month",
          "regex": "d[0-9][0-9]"
        },
        "linkPath": "/poseidon/stor/usage/storage/latest-monthly",
        "job": {
          "name": "metering-storage-monthly-$year-$month",
          "phases": [
            {
              "type": "reduce",
              "assets": [
                "/poseidon/stor/usage/assets/node_modules.tar",
                "/poseidon/stor/usage/assets/bin/sum-columns",
                "/poseidon/stor/usage/assets/lib/sum-columns.js"
              ],
              "exec": "/assets/poseidon/stor/usage/assets/bin/sum-columns",
              "count": 1
            }
          ]
        },
        "env": {
          "HEADER_CONTENT_TYPE": "application/x-json-stream",
          "DEST": "/poseidon/stor/usage/storage/$year/$month/m$month.json"
        }
      }
    },


    "request": {
      "hourly": {
        "keygen": "FindKeyGenerator",
        "keygenArgs": {
          "source": "/poseidon/stor/logs/muskie/$year/$month/$day/$hour"
        },
        "linkPath": "/poseidon/stor/usage/request/latest-hourly",
        "job": {
          "name": "metering-request-hourly-$year-$month-$dayT$hour",
          "phases": [
            {
              "type": "map",
              "assets": [
                "/poseidon/stor/usage/assets/etc/lookup.json",
                "/poseidon/stor/usage/assets/node_modules.tar",
                "/poseidon/stor/usage/assets/bin/request-map",
                "/poseidon/stor/usage/assets/lib/deliver-access.js",
                "/poseidon/stor/usage/assets/lib/request-map.js"
              ],
              "exec": "/assets/poseidon/stor/usage/assets/bin/request-map"
            },
            {
              "type": "reduce",
              "assets": [
                "/poseidon/stor/usage/assets/node_modules.tar",
                "/poseidon/stor/usage/assets/bin/sum-columns",
                "/poseidon/stor/usage/assets/lib/sum-columns.js"
              ],
              "exec": "/assets/poseidon/stor/usage/assets/bin/sum-columns",
              "count": 1
            },
            {
              "type": "reduce",
              "assets": [
                "/poseidon/stor/usage/assets/node_modules.tar",
                "/poseidon/stor/usage/assets/bin/deliver-usage",
                "/poseidon/stor/usage/assets/etc/lookup.json",
                "/poseidon/stor/usage/assets/lib/deliver-usage.js"
              ],
              "exec": "/assets/poseidon/stor/usage/assets/bin/deliver-usage",
              "count": 1
            }
          ]
        },
        "env": {
          "HEADER_CONTENT_TYPE": "application/x-json-stream",
          "DEST": "/poseidon/stor/usage/request/$year/$month/$day/$hour/h$hour.json",
          "ACCESS_DEST": "/reports/access-logs/$year/$month/$day/$hour/h$hour.json",
          "USER_DEST": "/reports/usage/request/$year/$month/$day/$hour/h$hour.json"
        }
      },


      "daily": {
        "keygen": "FindKeyGenerator",
        "keygenArgs": {
          "source": "/poseidon/stor/usage/request/$year/$month/$day",
          "regex": "h[0-9][0-9]"
        },
        "linkPath": "/poseidon/stor/usage/request/latest-daily",
        "job": {
          "name": "metering-request-daily-$year-$month-$day",
          "phases": [
            {
              "type": "reduce",
              "assets": [
                "/poseidon/stor/usage/assets/node_modules.tar",
                "/poseidon/stor/usage/assets/bin/sum-columns",
                "/poseidon/stor/usage/assets/lib/sum-columns.js"
              ],
              "exec": "/assets/poseidon/stor/usage/assets/bin/sum-columns",
              "count": 1
            }
          ]
        },
        "env": {
          "HEADER_CONTENT_TYPE": "application/x-json-stream",
          "DEST": "/poseidon/stor/usage/request/$year/$month/$day/d$day.json"
        }
      },


      "monthly": {
        "keygen": "FindKeyGenerator",
        "keygenArgs": {
          "source": "/poseidon/stor/usage/request/$year/$month",
          "regex": "d[0-9][0-9]"
        },
        "linkPath": "/poseidon/stor/usage/request/latest-monthly",
        "job": {
          "name": "metering-request-monthly-$year-$month",
          "phases": [
            {
              "type": "reduce",
              "assets": [
                "/poseidon/stor/usage/assets/node_modules.tar",
                "/poseidon/stor/usage/assets/bin/sum-columns",
                "/poseidon/stor/usage/assets/lib/sum-columns.js"
              ],
              "exec": "/assets/poseidon/stor/usage/assets/bin/sum-columns",
              "count": 1
            }
          ]
        },
        "env": {
          "HEADER_CONTENT_TYPE": "application/x-json-stream",
          "DEST": "/poseidon/stor/usage/request/$year/$month/m$month.json"
        }
      }
    },


    "compute": {
      "hourly": {
        "keygen": "FindKeyGenerator",
        "keygenArgs": {
          "source": "/poseidon/stor/logs/marlin-agent/$year/$month/$day/$hour"
        },
        "linkPath": "/poseidon/stor/usage/compute/latest-hourly",
        "job": {
          "name": "metering-compute-hourly-$year-$month-$dayT$hour",
          "phases": [
            {
              "type": "map",
              "assets": [
                "/poseidon/stor/usage/assets/node_modules.tar",
                "/poseidon/stor/usage/assets/bin/compute-map",
                "/poseidon/stor/usage/assets/lib/compute-map.js"
              ],
              "exec": "/assets/poseidon/stor/usage/assets/bin/compute-map"
            },
            {
              "type": "reduce",
              "assets": [
                "/poseidon/stor/usage/assets/node_modules.tar",
                "/poseidon/stor/usage/assets/bin/sum-columns",
                "/poseidon/stor/usage/assets/lib/sum-columns.js"
              ],
              "exec": "/assets/poseidon/stor/usage/assets/bin/sum-columns",
              "count": 1
            },
            {
              "type": "reduce",
              "assets": [
                "/poseidon/stor/usage/assets/node_modules.tar",
                "/poseidon/stor/usage/assets/bin/deliver-usage",
                "/poseidon/stor/usage/assets/etc/lookup.json",
                "/poseidon/stor/usage/assets/lib/deliver-usage.js"
              ],
              "exec": "/assets/poseidon/stor/usage/assets/bin/deliver-usage",
              "count": 1
            }
          ]
        },
        "env": {
          "HEADER_CONTENT_TYPE": "application/x-json-stream",
          "DEST": "/poseidon/stor/usage/compute/$year/$month/$day/$hour/h$hour.json",
          "USER_DEST": "/reports/usage/compute/$year/$month/$day/$hour/h$hour.json"
        }
      },


      "daily": {
        "keygen": "FindKeyGenerator",
        "keygenArgs": {
          "source": "/poseidon/stor/usage/compute/$year/$month/$day",
          "regex": "h[0-9][0-9]"
        },
        "linkPath": "/poseidon/stor/usage/compute/latest-daily",
        "job": {
          "name": "metering-compute-daily-$year-$month-$day",
          "phases": [
            {
              "type": "reduce",
              "assets": [
                "/poseidon/stor/usage/assets/node_modules.tar",
                "/poseidon/stor/usage/assets/bin/sum-columns",
                "/poseidon/stor/usage/assets/lib/sum-columns.js"
              ],
              "exec": "/assets/poseidon/stor/usage/assets/bin/sum-columns",
              "count": 1
            }
          ]
        },
        "env": {
          "HEADER_CONTENT_TYPE": "application/x-json-stream",
          "DEST": "/poseidon/stor/usage/compute/$year/$month/$day/d$day.json"
        }
      },


      "monthly": {
        "keygen": "FindKeyGenerator",
        "keygenArgs": {
          "source": "/poseidon/stor/usage/compute/$year/$month",
          "regex": "d[0-9][0-9]"
        },
        "linkPath": "/poseidon/stor/usage/compute/latest-monthly",
        "job": {
          "name": "metering-compute-monthly-$year-$month",
          "phases": [
            {
              "type": "reduce",
              "assets": [
                "/poseidon/stor/usage/assets/node_modules.tar",
                "/poseidon/stor/usage/assets/bin/sum-columns",
                "/poseidon/stor/usage/assets/lib/sum-columns.js"
              ],
              "exec": "/assets/poseidon/stor/usage/assets/bin/sum-columns",
              "count": 1
            }
          ]
        }
      },
        "env": {
          "HEADER_CONTENT_TYPE": "application/x-json-stream",
          "DEST": "/poseidon/stor/usage/compute/$year/$month/m$month.json"
        }
    }

  }
}
